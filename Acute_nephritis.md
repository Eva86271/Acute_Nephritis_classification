```python
import pandas as pd
import numpy as np
import csv
import seaborn as sns
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split,KFold,GridSearchCV
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.metrics import f1_score, accuracy_score, precision_score,confusion_matrix


```


```python
data1=pd.read_csv('C:/Users/subha/OneDrive/Desktop/diagnosis.csv',header=0)
```


```python
print(data1.head())

```

       Column1 Column2 Column3 Column4 Column5 Column6 Column7 Column8
    0     35.5      no     yes      no      no      no      no      no
    1     35.9      no      no     yes     yes     yes     yes      no
    2     35.9      no     yes      no      no      no      no      no
    3     36.0      no      no     yes     yes     yes     yes      no
    4     36.0      no     yes      no      no      no      no      no
    


```python
data1.columns=['Temp','nausea','Lumbarpain','urination','Micturitionpains','urethrasymptoms','Inflammation','Nephritis']
```


```python
print(data1)
```

         Temp nausea Lumbarpain urination Micturitionpains urethrasymptoms  \
    0    35.5     no        yes        no               no              no   
    1    35.9     no         no       yes              yes             yes   
    2    35.9     no        yes        no               no              no   
    3    36.0     no         no       yes              yes             yes   
    4    36.0     no        yes        no               no              no   
    ..    ...    ...        ...       ...              ...             ...   
    115  41.4     no        yes       yes               no             yes   
    116  41.5     no         no        no               no              no   
    117  41.5    yes        yes        no              yes              no   
    118  41.5     no        yes       yes               no             yes   
    119  41.5     no        yes       yes               no             yes   
    
        Inflammation Nephritis  
    0             no        no  
    1            yes        no  
    2             no        no  
    3            yes        no  
    4             no        no  
    ..           ...       ...  
    115           no       yes  
    116           no        no  
    117           no       yes  
    118           no       yes  
    119           no       yes  
    
    [120 rows x 8 columns]
    


```python
data1.dtypes
```




    Temp                float64
    nausea               object
    Lumbarpain           object
    urination            object
    Micturitionpains     object
    urethrasymptoms      object
    Inflammation         object
    Nephritis            object
    dtype: object




```python
for i in data1.columns:
    print(data1[i].isna().sum())
```

    0
    0
    0
    0
    0
    0
    0
    0
    


```python
sns.catplot(x="Nephritis", hue="Inflammation", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_7_0.png)



```python
sns.catplot(x="Nephritis", hue="nausea", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_8_0.png)



```python
sns.catplot(x="Nephritis", hue="Lumbarpain", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_9_0.png)



```python
sns.catplot(x="Nephritis", hue="urination", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_10_0.png)



```python
sns.catplot(x="Nephritis", hue="Micturitionpains", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_11_0.png)



```python
sns.catplot(x="Nephritis", hue="urethrasymptoms", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_12_0.png)



```python
sns.catplot(x="Inflammation", hue="urethrasymptoms", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_13_0.png)



```python
sns.catplot(x="Inflammation", hue="nausea", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_14_0.png)



```python
sns.catplot(x="Inflammation", hue="Lumbarpain", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_15_0.png)



```python
sns.catplot(x="Inflammation", hue="urination", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_16_0.png)



```python
sns.catplot(x="Inflammation", hue="Micturitionpains", kind="count",palette="pastel", edgecolor=".6",data=data1);
```


![png](output_17_0.png)



```python
sns.boxplot(data1['Temp'])
```




    <matplotlib.axes._subplots.AxesSubplot at 0x23ed2904e88>




![png](output_18_1.png)



```python
sns.distplot(data1['Temp'])
```




    <matplotlib.axes._subplots.AxesSubplot at 0x23ed2836ec8>




![png](output_19_1.png)



```python
mask=data1.Inflammation=="yes"
```


```python
data_new=data1[mask]
```


```python
mask1=data_new.Nephritis=="no"
```


```python
data_new1=data_new[mask1]
```


```python
data_new1.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp</th>
      <th>nausea</th>
      <th>Lumbarpain</th>
      <th>urination</th>
      <th>Micturitionpains</th>
      <th>urethrasymptoms</th>
      <th>Inflammation</th>
      <th>Nephritis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>35.9</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
    </tr>
    <tr>
      <th>3</th>
      <td>36.0</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
    </tr>
    <tr>
      <th>6</th>
      <td>36.2</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
    </tr>
    <tr>
      <th>8</th>
      <td>36.3</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
    </tr>
    <tr>
      <th>9</th>
      <td>36.6</td>
      <td>no</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>




```python
mask2=data_new.Nephritis=="yes"
```


```python
data_new2=data_new[mask2]
```


```python
data_new2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Temp</th>
      <th>nausea</th>
      <th>Lumbarpain</th>
      <th>urination</th>
      <th>Micturitionpains</th>
      <th>urethrasymptoms</th>
      <th>Inflammation</th>
      <th>Nephritis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>70</th>
      <td>40.0</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>71</th>
      <td>40.0</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>72</th>
      <td>40.0</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>78</th>
      <td>40.1</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
      <td>yes</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>79</th>
      <td>40.2</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
    </tr>
  </tbody>
</table>
</div>




```python
sns.distplot(data_new2['Temp'])
```




    <matplotlib.axes._subplots.AxesSubplot at 0x23ed2a6dbc8>




![png](output_28_1.png)



```python
sns.distplot(data_new1['Temp'])
```




    <matplotlib.axes._subplots.AxesSubplot at 0x23ed2aa3708>




![png](output_29_1.png)



```python
mask4=data1.Inflammation=="no"
```


```python
data_new4=data1[mask4]
```


```python
mask5=data_new4.Nephritis=="yes"
```


```python
data_new5=data_new4[mask5]
```


```python
sns.distplot(data_new5['Temp'])
```




    <matplotlib.axes._subplots.AxesSubplot at 0x23ed2829588>




![png](output_34_1.png)



```python
target=data1['Nephritis']
predictors=data1.drop('Nephritis',axis=1)
```


```python
lc=LabelEncoder()
sc=StandardScaler()
predictors['nausea']=lc.fit_transform(predictors['nausea'])
predictors['Lumbarpain']=lc.fit_transform(predictors['Lumbarpain'])
predictors['urination']=lc.fit_transform(predictors['urination'])
predictors['Micturitionpains']=lc.fit_transform(predictors['Micturitionpains'])
predictors['urethrasymptoms']=lc.fit_transform(predictors['urethrasymptoms'])
predictors['Inflammation']=lc.fit_transform(predictors['Inflammation'])
predictors=sc.fit_transform(predictors)
target=lc.fit_transform(target)
```


```python
print(predictors)
```

    [[-1.77979629 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.55898931 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.55898931 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.50378756 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.50378756 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.50378756 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.39338407 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.39338407 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.33818232 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.17257708 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.17257708 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.17257708 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.17257708 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.11737534 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.11737534 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.11737534 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.06217359 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.06217359 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.00697185 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.00697185 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.9517701  -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.89656836 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.89656836 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.89656836 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.84136661 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.84136661 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.84136661 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.78616486 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.78616486 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.78616486 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.73096312 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.73096312 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.67576137 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.67576137 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.62055963 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.62055963 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.62055963 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.56535788 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.56535788 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.56535788 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.56535788 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.51015613 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.51015613 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.51015613 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.45495439 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.45495439 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.45495439 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.45495439 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.45495439 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.39975264 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.39975264 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.3445509  -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.23414741 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.12374391 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.01334042 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.09706307 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.15226482 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.3730718  -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.53867704 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.70428227  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.70428227  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.70428227  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 0.70428227 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.70428227 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.70428227  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.70428227  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.70428227 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.75948402  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 0.81468577  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.81468577 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.81468577  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.86988751 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.92508926  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.92508926  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 0.92508926  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 0.92508926 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.92508926  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.980291    1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.03549275  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.03549275 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.03549275  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.09069449  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.09069449  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.09069449 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.09069449  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.09069449 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.14589624 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.20109799  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.20109799  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.20109799 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.25629973  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.25629973 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.25629973  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.25629973 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.31150148  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.31150148  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.31150148 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.31150148  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.31150148 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.36670322  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.36670322 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.36670322  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.36670322 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.42190497  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.47710672 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.53230846 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.53230846  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.53230846 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.53230846 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]]
    


```python
#Models 
dcr=DecisionTreeClassifier()
gb=GradientBoostingClassifier()
```


```python
X_train,X_test,Y_train,Y_test=train_test_split(predictors,target,test_size=0.25)
```


```python
print(X_train)
```

    [[ 1.53230846 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-1.11737534 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.84136661 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.51015613 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.36670322  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.62055963 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.56535788 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-1.17257708 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.51015613 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.92508926 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.25629973  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.86988751 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.78616486 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.45495439 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.50378756 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.70428227 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-1.77979629 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.70428227  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.33818232 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.45495439 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.03549275 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.20109799  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 0.15226482 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.78616486 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.03549275  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.50378756 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.25629973 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.89656836 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.84136661 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 0.3730718  -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.23414741 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.62055963 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.56535788 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.53230846  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.70428227 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.89656836 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [ 0.92508926  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.980291    1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.09069449 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.70428227 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.89656836 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.39338407 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.20109799  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-1.06217359 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.14589624 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-1.55898931 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.12374391 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.56535788 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-1.17257708 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.73096312 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.47710672 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.70428227  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.55898931 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.3445509  -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [-0.39975264 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.09069449  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 0.92508926  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [ 1.09069449  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [-1.06217359 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.53230846 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 0.70428227  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.81468577  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.53230846 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.31150148  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 1.36670322 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-1.11737534 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.20109799 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [ 1.31150148 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]
     [-0.73096312 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [ 1.31150148  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-1.00697185 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-1.50378756 -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [ 1.09069449 -0.56451866 -1.18321596 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.42190497  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.56535788 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [ 1.36670322  1.77142063  0.84515425 -1.41421356  1.0168079  -0.84515425
      -0.98346994]
     [ 0.92508926  1.77142063  0.84515425  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-1.39338407 -0.56451866  0.84515425 -1.41421356 -0.98346994 -0.84515425
      -0.98346994]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079   1.18321596
       1.0168079 ]
     [-0.9517701  -0.56451866 -1.18321596  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.67576137 -0.56451866 -1.18321596  0.70710678 -0.98346994 -0.84515425
       1.0168079 ]
     [ 0.70428227  1.77142063  0.84515425  0.70710678  1.0168079  -0.84515425
       1.0168079 ]
     [-0.39975264 -0.56451866  0.84515425  0.70710678 -0.98346994  1.18321596
      -0.98346994]]
    


```python
def modelselection_tree(model,parameters):
    model_tree=GridSearchCV(model,parameters,cv=5,verbose=1,n_jobs=1)
    model_tree.fit(X_train,Y_train)
    y_pred = model_tree.predict(X_test)
    print("Best parameters:")
    print(model_tree.best_params_)
    
    
```


```python
def modelselection_gbm(model,parameters):
    model_gbm=GridSearchCV(model,parameters,cv=5,verbose=1,n_jobs=1)
    model_gbm.fit(X_train,Y_train)
    y_pred = model_gbm.predict(X_test)
    print("Best parameters:")
    print(model_gbm.best_params_)
    
    
```


```python
## #Parameter defining for models and calling for cross validations
scoring = ['accuracy', 'precision']
parameter_for_gradient_boost={'loss':['deviance','exponential'],'learning_rate':[0.1,0.15,0.2,0.4],'max_features':['auto','sqrt'],'criterion':['friedman_mse','mse']}
parameter_for_tree={'max_features':['auto','sqrt','log2'],'criterion':['gini','entropy']}
print("Result for Decision Tree CLassifier")
dcr_model=modelselection_tree(dcr,parameter_for_tree)
print("Result for GradientBoosting Classifier")
gb_model=modelselection_gbm(gb,parameter_for_gradient_boost)

    
```

    Result for Decision Tree CLassifier
    Fitting 5 folds for each of 6 candidates, totalling 30 fits
    

    [Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
    [Parallel(n_jobs=1)]: Done  30 out of  30 | elapsed:    0.4s finished
    [Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
    

    Best parameters:
    {'criterion': 'gini', 'max_features': 'auto'}
    Result for GradientBoosting Classifier
    Fitting 5 folds for each of 32 candidates, totalling 160 fits
    

    [Parallel(n_jobs=1)]: Done 160 out of 160 | elapsed:  1.0min finished
    

    Best parameters:
    {'criterion': 'friedman_mse', 'learning_rate': 0.1, 'loss': 'deviance', 'max_features': 'sqrt'}
    


```python

gb_model=GradientBoostingClassifier(criterion='friedman_mse',learning_rate=0.1,loss='deviance',max_features='sqrt')
gb_model.fit(X_train,Y_train)
y_pred_gb=gb_model.predict(X_test)
```


```python
print(accuracy_score(Y_test,y_pred_gb))
```

    1.0
    


```python
print(f1_score(Y_test,y_pred_gb))
```

    1.0
    


```python
print(confusion_matrix(Y_test,y_pred_gb))
```

    [[19  0]
     [ 0 11]]
    


```python
dc_model=DecisionTreeClassifier(max_features='sqrt',criterion='gini')
```


```python
dc_model.fit(X_train,Y_train)
```




    DecisionTreeClassifier(ccp_alpha=0.0, class_weight=None, criterion='gini',
                           max_depth=None, max_features='sqrt', max_leaf_nodes=None,
                           min_impurity_decrease=0.0, min_impurity_split=None,
                           min_samples_leaf=1, min_samples_split=2,
                           min_weight_fraction_leaf=0.0, presort='deprecated',
                           random_state=None, splitter='best')




```python
y_pred_dc=dc_model.predict(X_test)
```


```python
print(accuracy_score(Y_test,y_pred_gb))
```

    1.0
    


```python
print(confusion_matrix(Y_test,y_pred_gb))
```

    [[19  0]
     [ 0 11]]
    


```python

```
